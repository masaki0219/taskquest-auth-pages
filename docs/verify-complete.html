<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ãƒ¡ãƒ¼ãƒ«èªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸ | TaskQuest</title>
    <style>
      :root {
        --bg1: #667eea;
        --bg2: #764ba2;
        --bg3: #f093fb;
      }
      body {
        margin: 0;
        min-height: 100vh;
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Noto Sans JP, Helvetica, Arial, sans-serif;
        color: #111827;
        background: linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
        display: grid;
        place-items: center;
      }
      .card {
        background: rgba(255,255,255,0.97);
        border-radius: 16px;
        padding: 28px 24px;
        max-width: 520px;
        width: calc(100% - 32px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        text-align: center;
      }
      h1 { font-size: 22px; margin: 0 0 12px; }
      p { margin: 8px 0; color: #374151; }
      .small { color: #6b7280; font-size: 12px; }
      .btn {
        display: inline-block;
        margin-top: 16px;
        padding: 12px 16px;
        background: #6366f1;
        color: #fff;
        border-radius: 10px;
        text-decoration: none;
        font-weight: 600;
      }
      .btn.secondary { background: #10b981; }
      .links { margin-top: 16px; display: grid; gap: 8px; }
      code { background: #f3f4f6; padding: 2px 6px; border-radius: 6px; }
    </style>
    <script>
      // èªè¨¼æˆåŠŸå¾Œã« Supabase ã‹ã‚‰ã“ã®ãƒšãƒ¼ã‚¸ã« ?code=...&type=signup ãªã©ã§é·ç§»ã—ã¦ãã¾ã™ã€‚
      // å¯èƒ½ãªã‚‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã¸ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªãƒ³ã‚¯ã§å—ã‘æ¸¡ã—ã€ãã‚ŒãŒç„¡ç†ã§ã‚‚æœ¬ãƒšãƒ¼ã‚¸ã§å®Œäº†æ¡ˆå†…ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
      function buildDeepLink() {
        const scheme = 'taskquestfresh://auth/callback';
        // å—ã‘å–ã£ãŸã‚¯ã‚¨ãƒªã‚’ãã®ã¾ã¾å¼•ãç¶™ãï¼ˆcode/type ç­‰ï¼‰
        const qs = window.location.search || '';
        return scheme + qs;
      }
      function tryOpenApp() {
        const deeplink = buildDeepLink();
        // ã™ãã«ã‚¢ãƒ—ãƒªã‚’é–‹ãè©¦è¡Œ
        window.location.href = deeplink;
        // å¤±æ•—æ™‚ã¯ãƒšãƒ¼ã‚¸ã«ç•™ã¾ã‚‹ï¼ˆGmailã‚¢ãƒ—ãƒªå†…ãªã©ï¼‰ã€‚
      }
      document.addEventListener('DOMContentLoaded', () => {
        // è‡ªå‹•ã§é–‹ãã®ã¯ 600ms å¾Œã«ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹å‡ºã—ã‚’ã¾ãšè¦‹ã›ã‚‹ã€‚
        setTimeout(tryOpenApp, 600);
        // Deep Linkã‚’ãƒœã‚¿ãƒ³ã«ã‚‚è¨­å®š
        const openBtn = document.getElementById('open-app');
        if (openBtn) openBtn.href = buildDeepLink();
      });
    </script>
  </head>
  <body>
    <main class="card">
      <h1>ãƒ¡ãƒ¼ãƒ«èªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸ ğŸ‰</h1>
      <p>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚</p>
      <p>ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹ã‹ã€ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰é–‹ã„ã¦ãã ã•ã„ã€‚</p>
      <a id="open-app" class="btn" href="#">ã‚¢ãƒ—ãƒªã‚’é–‹ã</a>
      <div class="links">
        <a class="btn secondary" href="/" onclick="history.back(); return false;">å‰ã®ç”»é¢ã«æˆ»ã‚‹</a>
        <p class="small">ãƒœã‚¿ãƒ³ã§é–‹ã‘ãªã„å ´åˆã¯ã€ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚</p>
      </div>
    </main>
  </body>
  </html>

